## 任务一：埋点平台相关理解

### 什么是埋点

埋点是指在系统（通常是前端）中，通过在代码中插入**采集点**（或在后台动态配置规则），来**记录用户行为或系统状态**的一种技术手段。

埋点内容一般会包含用户信息、页面信息、事件信息、访问信息等。

- 用户信息：包括用户的唯一标识（uid）、设备标识（token）、访问设备、浏览器版本以及网络状态等
- 页面信息：包括当前页面的 URL、标题、页面 ID 等信息
- 事件信息：包括用户的行为事件，如点击、滚动、鼠标移动等，以及事件的时间戳、元素路径、事件类型等信息
- 访问信息：包括用户来源、搜索关键词、渠道信息等，计算整个链路的渗透，或者在出现问题时，帮助还原整个用户操作路径，帮助开发者更快的定位、修复问题。

### 为什么需要埋点

#### 1. **用户行为分析**

通过埋点，可以记录用户在页面上的操作行为，例如点击、滚动、表单填写等数据，从而帮助我们了解：

- **用户关注点**：用户对哪些功能或内容感兴趣。
- **行为路径**：用户是如何在产品中完成特定任务的。
- **流失点分析**：用户在哪些步骤流失，从而优化用户体验。

#### 2. **产品功能优化**

埋点可以提供功能使用的详细数据，例如：

- **功能使用率**：统计某个按钮、功能或模块被使用的频率。
- **用户满意度间接评估**：通过分析行为模式判断功能是否符合用户预期。
- **A/B 测试支持**：通过埋点数据比较不同版本的效果，从数据上验证优化方向是否正确。

#### 3. **性能监控**

埋点还能帮助我们监控前端性能，包括：

- **页面加载时间**：如白屏时间、首屏渲染时间。
- **API 请求耗时**：统计后端接口的响应时间。
- **资源加载情况**：如图片或脚本的加载失败率。

#### 4. **异常监控**

通过异常埋点，我们可以捕获系统中发生的错误并及时处理进而提高系统的稳定性：

- **JavaScript 错误**：如未捕获的异常、资源加载失败。
- **用户操作导致的异常**：如非法输入。
- **前后端协作问题**：如后端返回的错误状态码。

#### 5. **业务增长和决策支持**

埋点数据是商业决策的重要基础：

- **用户分群**：通过埋点了解用户的行为特征，将用户分群（如活跃用户、流失用户）。
- **数据驱动增长**：分析不同渠道或功能带来的转化率。
- **辅助运营策略**：如通过埋点数据确定活动的最佳触达时间或内容。

#### 6. **生命周期管理**

埋点还能帮助我们管理产品的功能生命周期：

- **功能淘汰**：通过埋点判断哪些功能长期未被使用，考虑下线。
- **新增功能评估**：为新增功能埋点，监控其接受度和效果。

### 埋点方案分类

#### 代码埋点

代码埋点是最传统的埋点方式，开发者需要在代码中手动插入埋点逻辑。例如，当用户点击某个按钮时，代码中会显式地记录这一事件。

**优点**

- 精准：能够针对具体场景采集细粒度的数据。
- 灵活：可以根据业务需求自由定义采集内容和触发条件。

**缺点**

- 开发成本高：需要投入大量的开发资源。
- 易出错：容易出现漏埋、重复埋点等问题。

**示例**

```yaml
button.addEventListener('click', () => {
  sendTrackingEvent({
    eventName: 'button_click',
    buttonId: 'submit_button',
    timestamp: Date.now(),
  });
});
```

#### 可视化埋点

可视化埋点通过可视化配置工具实现，用户可以在界面上直接选取交互点生成埋点规则，而无需修改代码。国内支持可视化埋点的工具有 TalkingData、诸葛 IO、腾讯 MTA 等

**优点**

- 配置简单，非技术人员也能参与埋点规则的配置。
- 实时生效，无需重新发布代码即可更新埋点逻辑。

**缺点**

- 灵活性较差，对于复杂场景支持不足。
- 数据不可回溯

#### 无埋点

无埋点（或称全埋点）是一种通过拦截全局事件自动采集数据的方式，例如记录所有点击、输入或页面跳转操作。

**优点**

- 开发成本低：减少了手动埋点的工作量。
- 数据全面：能够采集到几乎所有用户行为。

**缺点**

- 数据冗余：需要对采集到的无效信息进行过滤和清洗。
- 性能影响：可能会对页面性能造成一定负担。

### 埋点平台化

1. 埋点管理
   1. 注册埋点，添加、删除埋点
   2. 埋点可视化
   3. 埋点规范代码生成平台
2. 埋点验证
   1. 测试埋点平台，可生成报告
3. 埋点发布
   1. 独立的埋点发布平台
4. 埋点监控
   1. 埋点数据回流
   2. 埋点错误上报

### 埋点管理

Q:为什么需要埋点管理？

A: 由于埋点数量多且分散，可能会出现：一个业务点被重复埋点（多次埋点记录同一事件）或每个埋点记录的业务参数不同，导致数据不一致或冗余。所以需要对买点进行管理减少重复和冲突。

#### 埋点规范

##### 类型代码约束

通过 typescript 为埋点的上报提供类型约束，避免埋点过程中出现数据格式、字段不一致等问题。

基本的埋点上报函数封装：

```yaml
type LogParams = Record<string, string | number | boolean | undefined | null>;

export const sendEvent = (event: string, params?: LogParams) => {
  // 埋点上传
};
```

使用类型体操实现升级：

```yaml
export const sendEvent = <T extends EventNames>(
  event: T,
  params?: TrackInterfaces[T]
) => {
  // 埋点上传
};

export interface TrackInterfaces {
  main_picture_click: MainPictureClick;
  page_view: PageView;
}

export type EventNames = "main_picture_click" | "page_view";

/**
 * 页面浏览
 */
export interface PageView {
  /**
   * 应用名称
   */
  appName: string;
  /**
   * 平台
   */
  device_platform: string;
  /**
   * 来源
   */
  enter_from: string;
  /**
   * 链接
   */
  page_url: string;
  /**
   * 页面名称
   */
  page_name: string;
}
```

参考：[https://juejin.cn/post/7415911686929268788?searchId=202501140032285385A0D5BDD19D35AABA#heading-27](https://juejin.cn/post/7415911686929268788?searchId=202501140032285385A0D5BDD19D35AABA#heading-27)

##### **埋点语义化**

#### 埋点生命周期

**问题背景**：

- 某些埋点在特定业务场景（如 A/B 测试）中被创建。
- 当对应的功能或业务场景被废弃时，这些埋点通常被遗忘，未及时清理。

**解决办法**：

- 给埋点打上时间戳，用于记录埋点的最新上报时间，也可用来分析每个埋点使用频率。
- 定期使用大数据分析手段，检查埋点的活跃度。
- 如果一个埋点长时间没有上报，可能意味着对应的功能已经不被使用，可以考虑删除这些埋点。

#### 埋点事件信息

##### <font style="color:rgb(51, 51, 51);">新建事件</font>

<font style="color:rgb(51, 51, 51);">生命周期的第一步，主要功能在于埋点的需求管理</font>

![](https://cdn.nlark.com/yuque/0/2025/png/42817320/1736873167906-340b56b4-4b5b-4a88-80f7-efe23a4c8a4a.png)

##### <font style="color:rgb(51, 51, 51);">事件查看</font>

<font style="color:rgb(51, 51, 51);">包括事件列表，事件的筛选以及查看等基本功能</font>

##### <font style="color:rgb(51, 51, 51);">事件编辑</font>

<font style="color:rgb(51, 51, 51);">事件信息以及属性信息的新增，更改以及删除</font>

##### <font style="color:rgb(51, 51, 51);">事件删除</font>

<font style="color:rgb(51, 51, 51);">主要指回收站以及删除操作</font>

![](https://cdn.nlark.com/yuque/0/2025/png/42817320/1736873287333-f22cc9ec-e170-488d-af52-3d5f9f3e5cf5.png)

其他参考文档：

[埋点管理\_全域采集与增长分析(Quick Tracking)-阿里云帮助中心](https://help.aliyun.com/document_detail/252715.html?spm=a2c4g.11186623.help-menu-194063.d_2_0_1.5b0ab61eNSkaFv&scm=20140722.H_252715._.OR_help-T_cn~zh-V_1)

[埋点管理 · 诸葛 io 使用文档](https://docs.zhugeio.com/datamanager/event_project.html)

## 开会分享

## 任务二：埋点平台相关技术选型
